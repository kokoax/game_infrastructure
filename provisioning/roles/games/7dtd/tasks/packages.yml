---
- name: Install packages
  yum:
    name: "{{ packages }}"
    state: installed
  vars:
    packages:
      - wget
      - rsync
      - gcc
      - libstdc++.i686
      - nc
      - tar
      - unzip
- name: Install steamcmd
  unarchive:
      src: https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz
      dest: /usr/local/bin
      remote_src: yes
- name: Install 7dtd server
  expect:
    command: /usr/local/bin/steamcmd.sh
    timeout: null
    responses:
      "Steam>":
        - "login anonymous"
        - "force_install_dir /root/7dtd"
        - "app_update 294420 validate"
        - "exit"
- name: Mkdir /root/7dtd/7DaysToDie/Data
  file:
    path: /root/7dtd/7DaysToDie/Data
    state: directory
    owner: root
    group: root
    mode: 0755
- name: Mkdir /root/7dtd/7DaysToDie/Saves
  file:
    path: /root/7dtd/7DaysToDie/Saves
    state: directory
    owner: root
    group: root
    mode: 0755
